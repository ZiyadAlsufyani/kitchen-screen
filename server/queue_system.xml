<?xml version="1.0" encoding="UTF-8"?>
<dds xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://community.rti.com/schema/7.3.0/rti_routing_service.xsd" version="7.3.0">
    <types>
      <const name="MAX_NAME_SIZE" type="int32" value="128"/>
      <const name="MAX_MSG_SIZE" type="int32" value="512"/>
      <struct name="QueueMessage">
        <member name="fromDevice" type="string" stringMaxLength="MAX_NAME_SIZE" key="true"/>
        <member name="toDevice" type="string" stringMaxLength="MAX_NAME_SIZE" key="true"/>
        <member name="message" type="string" stringMaxLength="MAX_MSG_SIZE"/>
      </struct>
    </types>

    <qos_library name="Queue_Library">
      <qos_profile name="QueueMessage_Profile">
        <datareader_qos>
          <subscription_name>
            <name>ChatMessage_Reader</name>
          </subscription_name>
        </datareader_qos>
        <datawriter_qos>
          <reliability>
            <kind>BEST_EFFORT_RELIABILITY_QOS</kind>
          </reliability>
          <publication_name>
            <name>ChatMessage_Writer</name>
          </publication_name>
        </datawriter_qos>
      </qos_profile>
      <qos_profile name="Queue_Profile">
        <domain_participant_qos>
          <participant_name>
            <name>queueApp</name>
          </participant_name>
        </domain_participant_qos>
      </qos_profile>
    </qos_library>

    <domain_library name="Queue_DomainLibrary">
      <domain name="Queue_Domain" domain_id="1">
        <register_type name="ChatMessage" type_ref="QueueMessage"/>
        <topic name="message" register_type_ref="ChatMessage"/>
      </domain>
    </domain_library>

    <domain_participant_library name="Queue_ParticipantLibrary">
      <domain_participant name="QueueParticipant" domain_ref="Queue_DomainLibrary::Queue_Domain">
        <publisher name="QueueMessagePublisher">
          <data_writer name="QueueMessageWriter" topic_ref="message">
            <datawriter_qos base_name="Queue_Library::QueueMessage_Profile">
            </datawriter_qos>
          </data_writer>
          <publisher_qos base_name="Queue_Library::QueueMessage_Profile">
          </publisher_qos>
        </publisher>
        <subscriber name="QueueMessageSubscriber">
          <data_reader name="QueueMessageReader" topic_ref="message">
            <content_filter name="MessageFilter" kind="builtin.sql">
              <expression>(toDevice MATCH %0)</expression>
              <expression_parameters>
                <element>&apos;$(toDevice)&apos;</element>
              </expression_parameters>
            </content_filter>
            <datareader_qos base_name="Queue_Library::QueueMessage_Profile">
            </datareader_qos>
          </data_reader>
          <subscriber_qos base_name="Queue_Library::QueueMessage_Profile">
          </subscriber_qos>
        </subscriber>
        <domain_participant_qos base_name="Queue_Library::Queue_Profile">
        </domain_participant_qos>
      </domain_participant>
    </domain_participant_library>

</dds>
